<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple Google Maps Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        iframe {
            width: 100%;
            height: 450px;
            border: 0;
            border-radius: 8px;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <h1>Simple Google Maps Test</h1>
    
    <h2>Working Example (Your Format)</h2>
    <p>This is the working example you provided:</p>
    <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d6204.450648988351!2d-77.08006951319453!3d38.96452265412205!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x89b7c9a3b1d8124d%3A0x68ad77cf2b2381fd!2sThe%20Avalon%20Theatre!5e0!3m2!1szh-CN!2sus!4v1757989736646!5m2!1szh-CN!2sus" 
           allowfullscreen="" 
           loading="lazy" 
           referrerpolicy="no-referrer-when-downgrade">
    </iframe>

    <h2>Generated URL Test (Beijing)</h2>
    <p>This uses our generated URL format:</p>
    <div id="generated-map"></div>

    <h2>URL Comparison</h2>
    <div id="url-comparison"></div>

    <script>
        // Generate URL using our plugin logic
        function generateMapUrl(lat, lng, zoom = 13) {
            const distance = 156543.03392 * Math.cos(lat * Math.PI / 180) / Math.pow(2, zoom);
            const timestamp = Date.now();
            const language = 'zh-CN';
            const region = 'us';
            
            const pb = [
                '!1m18',
                '!1m12',
                '!1m3',
                `!1d${distance.toFixed(15)}`,
                `!2d${lng}`,
                `!3d${lat}`,
                '!2m3',
                '!1f0',
                '!2f0',
                '!3f0',
                '!3m2',
                '!1i1024',
                '!2i768',
                `!4f${zoom}.1`,
                '!5e0',
                '!3m2',
                `!1s${language}`,
                `!2s${region}`,
                `!4v${timestamp}`,
                '!5m2',
                `!1s${language}`,
                `!2s${region}`
            ].join('');
            
            return `https://www.google.com/maps/embed?pb=${pb}`;
        }

        // Test with Beijing coordinates
        const beijingLat = 39.9042;
        const beijingLng = 116.4074;
        const generatedUrl = generateMapUrl(beijingLat, beijingLng, 12);
        
        // Create iframe with generated URL
        const iframe = document.createElement('iframe');
        iframe.src = generatedUrl;
        iframe.width = '100%';
        iframe.height = '450';
        iframe.style.border = '0';
        iframe.style.borderRadius = '8px';
        iframe.allowFullscreen = true;
        iframe.loading = 'lazy';
        iframe.referrerPolicy = 'no-referrer-when-downgrade';
        
        document.getElementById('generated-map').appendChild(iframe);
        
        // Show URL comparison
        const workingUrl = "https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d6204.450648988351!2d-77.08006951319453!3d38.96452265412205!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x89b7c9a3b1d8124d%3A0x68ad77cf2b2381fd!2sThe%20Avalon%20Theatre!5e0!3m2!1szh-CN!2sus!4v1757989736646!5m2!1szh-CN!2sus";
        
        document.getElementById('url-comparison').innerHTML = `
            <h3>Working URL (Your Example):</h3>
            <p style="word-break: break-all; font-size: 12px; background: #f0f0f0; padding: 10px; border-radius: 4px;">
                ${workingUrl}
            </p>
            
            <h3>Generated URL (Our Plugin):</h3>
            <p style="word-break: break-all; font-size: 12px; background: #f0f0f0; padding: 10px; border-radius: 4px;">
                ${generatedUrl}
            </p>
            
            <h3>Analysis:</h3>
            <ul>
                <li><strong>Working URL coordinates:</strong> lat=38.96452265412205, lng=-77.08006951319453</li>
                <li><strong>Generated URL coordinates:</strong> lat=${beijingLat}, lng=${beijingLng}</li>
                <li><strong>Distance calculation:</strong> ${(156543.03392 * Math.cos(beijingLat * Math.PI / 180) / Math.pow(2, 12)).toFixed(15)}</li>
            </ul>
        `;
        
        // Test the generated URL by trying to load it
        iframe.onload = function() {
            console.log('✅ Generated URL loaded successfully!');
        };
        
        iframe.onerror = function() {
            console.log('❌ Generated URL failed to load');
        };
    </script>
</body>
</html>
